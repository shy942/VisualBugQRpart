package imgui android import android app native activity import android bundle import android content context import android view inputmethod input method manager import android view key event import java util concurrent linked blocking queue class main activity native activity public override fun create saved instance bundle super create saved instance fun soft input val input method manager service context input method service input method manager input method manager soft input window decor view fun hide soft input val input method manager service context input method service input method manager input method manager hide soft input window window decor view window token queue unicode characters polled native code poll unicode char private var unicode character queue linked blocking queue int linked blocking queue assume dispatch key event native activity called key event consumed view reaches override fun dispatch key event event key event boolean event action key event action unicode character queue offer event unicode char event meta return super dispatch key event event fun poll unicode char int return unicode character queue poll