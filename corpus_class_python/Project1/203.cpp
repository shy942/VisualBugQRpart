dear imgui free type font builder replacement stb truetype builder code latest version original code vuhdo aleksei skriabin improvements mikesart maintained ocornut changelog minor older stripped git history details support font config rasterization density field scaling render density scaling metrics support svg fonts enable define imgui enable freetype lunasvg fixed packing issue occurrences prevent large glyphs packed correctly fixed crash render glyph fails render glyph returns null gui free type builder flags bitmap load bitmap glyphs set atlas tex pixels colors true backends deciding prefered texture format support color layered glyphs gui free type builder flags load color require freetype simplified integration define imgui enable freetype renamed gui free type xxx flags gui free type builder flags xxx consistency api removed gui free type build font atlas rare case char succeed load glyph fails rasterizer flags monochrome flag disable font anti aliasing combine mono hinting support imgui allocators free type override function set allocator functions factored match big update stb builder fixed texture height waste fixed redundant glyphs merging support glyph padding support font config glyph min advance glyph max advance moved main imgui repository addition font atlas tex uvscale member minor inconsequential change match change master removed unnecessary statement fixes imgui internal cleanup optimizations support font config rasterizer flags font config rasterizer multiply imported updated latest font atlas minor tweaks gamma correct blending free type assumes blending linear space gamma space correct rgb convert linear space pixel shader output default dear imgui styles impacted change alpha values tweaking fixme cfg oversample oversample supported rasterizer include imgui ifndef imgui disable include imgui freetype include imgui internal min max font atlas build include stdint include build include freetype freetype freetype include module freetype ftmodapi include glyph freetype ftglyph include synthesis freetype ftsynth ifdef imgui enable freetype lunasvg include otsvg freetype otsvg include bbox freetype ftbbox include lunasvg freetype major freetype minor error imgui enable freetype lunasvg requires free type version endif endif ifdef msc ver pragma warning push pragma warning disable unreferenced local function removed stb stuff pragma warning disable static analyzer enum type xxx unscoped prefer enum class enum enum endif ifdef gnuc pragma gcc diagnostic push pragma gcc diagnostic wpragmas warning unknown option pragma gcc diagnostic kind pragma gcc diagnostic wunused function warning xxxx defined ifndef clang pragma gcc diagnostic wsubobject linkage warning xxxx field xxxx type anonymous namespace endif endif data default memory allocators static void gui free type default alloc func size size void user data unused user data return alloc size static void gui free type default free func void ptr void user data unused user data free ptr current memory allocators static void gui free type alloc func size size void user data gui free type default alloc func static void gui free type free func void ptr void user data gui free type default free func static void gui free type allocator user data nullptr lunasvg support ifdef imgui enable freetype lunasvg static error gui lunasvg port init pointer static void gui lunasvg port free pointer static error gui lunasvg port render glyph slot slot pointer static error gui lunasvg port preset slot glyph slot slot bool cache pointer endif code namespace glyph metrics xmin xmax width ymax ggggggggg ggggg ggg ggggg offset offset ggggg height baseline gggggggg origin gggggg ggg ggg ggg gggggg ymin advance structure glyph struct glyph info int width glyph width pixels int height glyph height pixels int offset distance origin pen position left glyph int offset distance origin glyph float advance distance origin origin glyph bool colored glyph colored font parameters metrics struct font info uint pixel height size font generated float ascender pixel extents baseline pixels typically positive float descender extents baseline pixels typically negative float spacing baseline baseline distance note larger sum ascender descender absolute values guarantee glyphs extend subsequent baselines distance designer font finds float gap spacing pixels row descent row ascent float max advance width field maximum horizontal cursor advance glyphs font free type glyph rasterizer ctor dtor explicitly init shutdown struct free type font bool init font library library const font config cfg unsigned int extra user flags initialize external data buffer copy data ensure stays valid object lifetime void close font void set pixel height int pixel height change font pixel size calls rasterize glyph size const glyph metrics load glyph uint codepoint const bitmap render glyph info glyph info glyph info void blit glyph const bitmap bitmap uint dst uint dst pitch unsigned char multiply table nullptr free type font close font internals font info info font descriptor current font face face unsigned int user flags font config rasterizer flags int load flags render mode render mode float rasterization density float inv rasterization density sdl ttf handy routines converting fixed point define ceil bool free type font init font library library const font config cfg unsigned int extra font builder flags error error memory face library uint cfg font data uint cfg font data size uint cfg font face error return false error select charmap face encoding unicode error return false convert free type flags bold oblique processed separately user flags cfg font builder flags extra font builder flags load flags user flags gui free type builder flags bitmap load flags load bitmap user flags gui free type builder flags hinting load flags load hinting user flags gui free type builder flags auto hint load flags load autohint user flags gui free type builder flags force auto hint load flags load force autohint user flags gui free type builder flags light hinting load flags load target light user flags gui free type builder flags mono hinting load flags load target mono load flags load target normal user flags gui free type builder flags monochrome render mode render mode mono render mode render mode normal user flags gui free type builder flags load color load flags load color rasterization density cfg rasterizer density inv rasterization density rasterization density memset info sizeof info set pixel height uint cfg size pixels return true void free type font close font face face face face nullptr void free type font set pixel height int pixel height vuhdo deal font sizes properly understand gui assumes pixel height maximum height glyph sum font ascender descender strange set pixel sizes result size request rec req req type user flags gui free type builder flags bitmap size request type nominal size request type real dim req width req height uint pixel height rasterization density req hori resolution req vert resolution request size face req update font info size metrics metrics face size metrics info pixel height uint pixel height inv rasterization density info ascender float ceil metrics ascender inv rasterization density info descender float ceil metrics descender inv rasterization density info spacing float ceil metrics height inv rasterization density info gap float ceil metrics height metrics ascender metrics descender inv rasterization density info max advance width float ceil metrics max advance inv rasterization density const glyph metrics free type font load glyph uint codepoint uint glyph char face codepoint glyph return nullptr crash free type crash bug bitmap colored fonts free type patched version pkg upcoming free type version error error load glyph face glyph load flags error return nullptr outline work glyph slot slot face glyph ifdef imgui enable freetype lunasvg assert slot format glyph format outline slot format glyph format bitmap slot format glyph format svg freetype major freetype minor assert slot format glyph format svg font svg glyphs enable imgui enable freetype lunasvg imconfig install required libraries order font endif assert slot format glyph format outline slot format glyph format bitmap endif imgui enable freetype lunasvg apply convenience transform picking real bold italic fonts applying free type helper transform oblique slanting user flags gui free type builder flags bold glyph slot embolden slot user flags gui free type builder flags oblique glyph slot oblique slot box bbox outline box slot outline bbox slot metrics width bbox max bbox min slot metrics height bbox max bbox min return slot metrics const bitmap free type font render glyph info glyph info glyph info glyph slot slot face glyph error error render glyph slot render mode error return nullptr bitmap bitmap face glyph bitmap glyph info width int bitmap width glyph info height int bitmap rows glyph info offset face glyph bitmap left glyph info offset face glyph bitmap glyph info advance float ceil slot advance glyph info colored bitmap pixel mode pixel mode bgra return bitmap void free type font blit glyph const bitmap bitmap uint dst uint dst pitch unsigned char multiply table assert bitmap nullptr const uint bitmap width const uint bitmap rows const uint src bitmap buffer const uint src pitch bitmap pitch switch bitmap pixel mode case pixel mode gray grayscale image byte pixel multiply table nullptr uint src src pitch dst dst pitch uint dst col src uint src src pitch dst dst pitch uint dst col multiply table src break case pixel mode mono monochrome image bit pixel bits byte ordered msb lsb uint color multiply table multiply table uint color multiply table multiply table uint src src pitch dst dst pitch uint bits const uint bits ptr src uint bits bits bits ptr dst col bits color color break case pixel mode bgra fixme converting pre multiplied alpha straight smell good define multiply color alpha float color float alpha multiply table nullptr uint src src pitch dst dst pitch uint uint src src src src dst col multiply multiply multiply uint src src pitch dst dst pitch uint uint src src src src dst col multiply table multiply multiply table multiply multiply table multiply multiply table undef multiply break default assert free type font blit glyph unknown bitmap pixel mode namespace ifndef stb rect pack implementation case user implementation compilation unit unity builds ifndef imgui disable stb rect pack implementation define stbrp assert assert define stbrp static define stb rect pack implementation endif ifdef imgui stb rect pack filename include imgui stb rect pack filename include imstb rectpack endif endif struct font build src glyph glyph info info uint codepoint unsigned int bitmap data point dst tmp bitmap buffers array font build src glyph memset void sizeof struct font build src data free type font font stbrp rect rects rectangle pack size packer position const wchar src ranges ranges requested user user allowed request ffff int dst atlas fonts dst tmp array int glyphs highest highest requested codepoint int glyphs count glyph count excluding missing glyphs glyphs set earlier source font bit vector glyphs set glyph bit map random access bit codepoint maximum vector font build src glyph glyphs list temporary data destination font multiple source fonts merged destination font struct font build dst data int src count number source fonts targeting destination font int glyphs highest int glyphs count bit vector glyphs set resolve collision multiple sources merged destination font bool font atlas build free type library library font atlas atlas unsigned int extra flags assert atlas config data size font atlas build init atlas clear atlas atlas tex atlas tex width atlas tex height atlas tex scale vec atlas tex white pixel vec atlas clear tex data temporary storage building bool src load color false vector font build src data src tmp array vector font build dst data dst tmp array src tmp array resize atlas config data size dst tmp array resize atlas fonts size memset void src tmp array data size src tmp array size bytes memset void dst tmp array data size dst tmp array size bytes initialize font loading structure check font data validity int src src atlas config data size src font build src data src tmp src tmp array src font config cfg atlas config data src free type font font face src tmp font assert cfg dst font cfg dst font loaded cfg dst font container atlas atlas cfg dst font user set cfg dst font casual debugging nicer storing indices src tmp dst int output output atlas fonts size src tmp dst output cfg dst font atlas fonts output src tmp dst output assert src tmp dst cfg dst font pointing atlas fonts array src tmp dst return false load font font face init font library cfg extra flags return false measure highest codepoints src load color cfg font builder flags gui free type builder flags load color font build dst data dst tmp dst tmp array src tmp dst src tmp src ranges cfg glyph ranges cfg glyph ranges atlas glyph ranges default const wchar src range src tmp src ranges src range src range src range check valid range detect dangling pointers common user error setup font config glyph ranges pointer data persistent assert src range src range src tmp glyphs highest max src tmp glyphs highest int src range dst tmp src count dst tmp glyphs highest max dst tmp glyphs highest src tmp glyphs highest requested codepoint check presence font data handle redundancy overlaps source fonts avoid unused glyphs int total glyphs count int src src src tmp array size src font build src data src tmp src tmp array src font build dst data dst tmp dst tmp array src tmp dst src tmp glyphs set create src tmp glyphs highest dst tmp glyphs set storage dst tmp glyphs set create dst tmp glyphs highest const wchar src range src tmp src ranges src range src range src range int codepoint src range codepoint int src range codepoint dst tmp glyphs set test bit codepoint overwrite existing glyphs option merge overwrite continue uint glyph char src tmp font face codepoint font fixme opt storing glyph glyph continue add avail set counters src tmp glyphs count dst tmp glyphs count src tmp glyphs set set bit codepoint dst tmp glyphs set set bit codepoint total glyphs count unpack bit map flat list unicode points requested overlapping int src src src tmp array size src font build src data src tmp src tmp array src src tmp glyphs list reserve src tmp glyphs count assert sizeof src tmp glyphs set storage data sizeof const src tmp glyphs set storage const src tmp glyphs set storage const entries bit bit bit entries bit font build src glyph src glyph src glyph codepoint wchar bit src glyph glyph fixme opt info previous step lost src tmp glyphs list push src glyph src tmp glyphs set clear assert src tmp glyphs list size src tmp glyphs count int dst dst dst tmp array size dst dst tmp array dst glyphs set clear dst tmp array clear allocate packing character data flag packed characters buffer packed technically clear buf rects sake sanity vector stbrp rect buf rects buf rects resize total glyphs count memset buf rects data size buf rects size bytes allocate temporary rasterization data buffers retrieve accurate glyph size rendering slot metrics width matching bitmap width oblique transform allocate chunks waste extra memory users free type mind temporary allocations const int bitmap buffers chunk size int buf bitmap current bytes vector unsigned char buf bitmap buffers buf bitmap buffers push unsigned char alloc bitmap buffers chunk size gather glyphs sizes pack virtual canvas render rasterize font characters texture int total surface int buf rects int src src src tmp array size src font build src data src tmp src tmp array src font config cfg atlas config data src src tmp glyphs count continue src tmp rects buf rects buf rects buf rects src tmp glyphs count compute multiply table requested const bool multiply enabled cfg rasterizer multiply unsigned char multiply table multiply enabled font atlas build multiply calc lookup table multiply table cfg rasterizer multiply gather sizes rectangles pack const int padding atlas tex glyph padding int glyph glyph src tmp glyphs list size glyph font build src glyph src glyph src tmp glyphs list glyph const glyph metrics metrics src tmp font load glyph src glyph codepoint metrics nullptr continue render glyph bitmap held free type const bitmap bitmap src tmp font render glyph info src glyph info bitmap nullptr continue allocate temporary chunk needed const int bitmap size bytes src glyph info width src glyph info height buf bitmap current bytes bitmap size bytes bitmap buffers chunk size buf bitmap current bytes buf bitmap buffers push unsigned char alloc bitmap buffers chunk size assert buf bitmap current bytes bitmap size bytes bitmap buffers chunk size allocate custom sized buffer blit rasterized pixels temporary buffer pointer src glyph bitmap data unsigned int buf bitmap buffers buf bitmap current bytes buf bitmap current bytes bitmap size bytes src tmp font blit glyph bitmap src glyph bitmap data src glyph info width multiply enabled multiply table nullptr src tmp rects glyph stbrp coord src glyph info width padding src tmp rects glyph stbrp coord src glyph info height padding total surface src tmp rects glyph src tmp rects glyph width skyline algorithm width exact width matter api gpu texture size limitations increasing width decrease height user override tex desired width tex glyph padding simple heuristic select width based expected surface const int surface sqrt int sqrt float total surface atlas tex height atlas tex desired width atlas tex width atlas tex desired width atlas tex width surface sqrt surface sqrt surface sqrt start packing pack extra data rectangles upper left corner texture small values const int tex height max const int num nodes packing algorithm atlas tex width atlas tex glyph padding vector stbrp node pack nodes pack nodes resize num nodes packing algorithm stbrp context pack context stbrp init target pack context atlas tex width atlas tex glyph padding tex height max atlas tex glyph padding pack nodes data pack nodes size font atlas build pack custom rects atlas pack context pack source font rendering working rectangles infinitely tall texture point int src src src tmp array size src font build src data src tmp src tmp array src src tmp glyphs count continue stbrp pack rects pack context src tmp rects src tmp glyphs count extend texture height mark missing glyphs packed render fixme handling packing failure happen tex height max single larger tex width int glyph glyph src tmp glyphs count glyph src tmp rects glyph packed atlas tex height max atlas tex height src tmp rects glyph src tmp rects glyph allocate texture atlas tex height atlas flags font atlas flags power height atlas tex height upper power atlas tex height atlas tex scale vec atlas tex width atlas tex height src load color size tex size size atlas tex width atlas tex height atlas tex pixels rgba unsigned int alloc tex size memset atlas tex pixels rgba tex size size tex size size atlas tex width atlas tex height atlas tex pixels alpha unsigned char alloc tex size memset atlas tex pixels alpha tex size copy rasterized font characters main texture setup font glyphs runtime bool tex colors false int src src src tmp array size src font build src data src tmp src tmp array src src tmp glyphs count continue merging fonts merge mode true multiple input fonts writing destination font dst font config data cfg source configuration font config cfg atlas config data src font dst font cfg dst font const float ascent src tmp font info ascender const float descent src tmp font info descender font atlas build setup font atlas dst font cfg ascent descent const float font cfg glyph offset const float font cfg glyph offset dst font ascent const int padding atlas tex glyph padding int glyph glyph src tmp glyphs count glyph font build src glyph src glyph src tmp glyphs list glyph stbrp rect pack rect src tmp rects glyph assert pack rect packed pack rect pack rect continue glyph info info src glyph info assert info width padding pack rect assert info height padding pack rect const int pack rect padding const int pack rect padding register glyph float info offset src tmp font inv rasterization density font float info offset src tmp font inv rasterization density font float info width src tmp font inv rasterization density float info height src tmp font inv rasterization density float float atlas tex width float float atlas tex height float info width float atlas tex width float info height float atlas tex height dst font add glyph cfg wchar src glyph codepoint info advance src tmp font inv rasterization density font glyph dst glyph dst font glyphs assert dst glyph codepoint src glyph codepoint src glyph info colored dst glyph colored tex colors true blit temporary buffer final texture size blit src stride size src glyph info width size blit dst stride size atlas tex width unsigned int blit src src glyph bitmap data atlas tex pixels alpha nullptr unsigned char blit dst atlas tex pixels alpha blit dst stride int info height blit dst blit dst stride blit src blit src stride int info width blit dst unsigned char blit src col shift unsigned int blit dst atlas tex pixels rgba blit dst stride int info height blit dst blit dst stride blit src blit src stride int info width blit dst blit src src tmp rects nullptr atlas tex pixels colors tex colors cleanup int buf buf buf bitmap buffers size buf free buf bitmap buffers buf src tmp array clear destruct font atlas build finish atlas return true free type memory allocation callbacks static void free type alloc memory memory long size return gui free type alloc func size size gui free type allocator user data static void free type free memory memory void block gui free type free func block gui free type allocator user data static void free type realloc memory memory long cur size long size void block implement realloc user provide block nullptr return gui free type alloc func size size gui free type allocator user data size gui free type free func block gui free type allocator user data return nullptr size cur size void block gui free type alloc func size size gui free type allocator user data memcpy block block size cur size gui free type free func block gui free type allocator user data return block return block static bool font atlas build free type font atlas atlas free type memory management memory rec memory rec memory rec user nullptr memory rec alloc free type alloc memory rec free free type free memory rec realloc free type realloc library library error error library memory rec library error return false add default modules rest code work free type custom allocator add default modules library ifdef imgui enable freetype lunasvg install svg hooks free type svg renderer hooks hooks gui lunasvg port init gui lunasvg port free gui lunasvg port render gui lunasvg port preset slot property set library svg svg hooks hooks endif imgui enable freetype lunasvg bool ret font atlas build free type library atlas atlas font builder flags library library return ret const font builder gui free type builder free type static font builder font builder build font atlas build free type return void gui free type set allocator functions void alloc func size void user data void free func void ptr void user data void user data gui free type alloc func alloc func gui free type free func free func gui free type allocator user data user data ifdef imgui enable freetype lunasvg details original code demo licensed cill free software license agreement struct lunasvg port error err err lunasvg matrix matrix std unique ptr lunasvg document svg nullptr static error gui lunasvg port init pointer lunasvg port return err static void gui lunasvg port free pointer delete lunasvg port static error gui lunasvg port render glyph slot slot pointer lunasvg port lunasvg port error loading svg gui lunasvg port preset slot renderer hook called returns error err err return err rows height pitch stride equals width sizeof int lunasvg bitmap bitmap uint slot bitmap buffer slot bitmap width slot bitmap rows slot bitmap pitch svg set matrix svg matrix identity reset svg matrix default svg render bitmap matrix matrix scaled translated err err return err static error gui lunasvg port preset slot glyph slot slot bool cache pointer svg document document svg document slot lunasvg port lunasvg port size metrics metrics document metrics function called load glyph gui lunasvg port render cache return err svg lunasvg document load data const char document svg document document svg document length svg nullptr err err invalid svg document return err lunasvg box box svg box double scale std min metrics ppem box metrics ppem box double double document transform double double document transform double double document transform double double document transform double double document delta box metrics ppem double double document delta box metrics ppem scale transform translate svg matrix identity matrix scale scale scale matrix transform svg set matrix matrix pre translate matrix rendering step matrix translate box box box transformation box svg box calculate bitmap size slot bitmap left int box slot bitmap int box slot bitmap rows unsigned int ceil float box slot bitmap width unsigned int ceil float box slot bitmap pitch slot bitmap width slot bitmap pixel mode pixel mode bgra compute bearings set correctly outline scaled bounding box double metrics width box double metrics height box double hori bearing box double hori bearing box double vert bearing slot metrics hori bearing slot metrics hori advance double vert bearing slot metrics vert advance slot metrics height slot metrics width pos metrics width assume width height positive slot metrics height pos metrics height slot metrics hori bearing pos hori bearing slot metrics hori bearing pos hori bearing slot metrics vert bearing pos vert bearing slot metrics vert bearing pos vert bearing slot metrics vert advance slot metrics vert advance pos metrics height err err return err endif ifdef imgui enable freetype lunasvg ifdef gnuc pragma gcc diagnostic pop endif ifdef msc ver pragma warning pop endif endif ifndef imgui disable